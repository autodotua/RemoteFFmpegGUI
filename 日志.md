#FFmpeg工具箱

##20210805

做了一番比较以后，最终确定如下结构，并做了初步测试：


|项目名|项目名（中文）|介绍|
|-|-|-|
|Core|核心|提供Host和WPF、Web的契约以及公共方法|
|Host|主机|对FFmpeg进行包装，实现其功能，并通过NamedPipe进行发布|
|WPF|桌面GUI|本地执行的桌面端的GUI实现|
|WebAPI|服务端|使用ASP.NetCore实现的服务器|
|Web|Web客户端|使用Vue.js实现的网页端|

完成了Host与WebAPI之间的连接、WebAPI和Web之间的连接

## 20210810

搭建中。。初步完成了新增转码任务

## 20210811

【Core】新增了数据库连接

【Core】初步完成了任务队列系统

【Web】新增任务列表界面

## 20210812

【Web】进一步完成了任务的删除等、完成新增编码任务的界面等

【Web】优化界面，初步完成编码预设的后端

## 20210813

【Core】【Web】新增多文件拼接的支持

【Core】【Web】新增视频裁剪的支持

【Web】支持了新增、更新、调用预设

【Web】【Web】支持了额外参数

## 20210814

【Core】将Host的众多类移到Core中，Host仅用于提供管道通信

【Core】将DbContext改为单例模式

【Web】支持自定义管道名

【Web】新增FTP服务器功能

## 20210815

【Web】修改管道客户端类为依赖注入

【Web】新增在调用管道时，若检测到提供商未运行，则会自动启动

【Web】完成对任务列表的分页和筛选

【Web】修复了获取数据库信息时，并行查询报错的BUG

【Web】新增预设列表和日志列表

【Web】优化了错误信息的提示

## 20210816

【Web】新增支持上传小文件和直接下载输出文件

【Web】优化：在滚动时，左侧导航栏将固定

【Web】修复了当IIS无权限访问输入输出文件夹时无法使用的问题，通过Host访问来解决

【Web】优化了UI

## 20210817

【Web】优化了UI

【Web】新增支持视频裁剪设置中，可以粘贴一串时间字符串后自动解析为时分秒

【Core】【Web】新增支持不导出视频或不导出音频

## 20210818

【Web】优化了UI

【Core】【Web】支持指定视频容器

【Core】【Web】新增合并音视频功能

【Web】基本完成token认证功能

## 20210819

【Core】【Web】新增视频对比功能

【Web】新增重制时，可以保留文件

【Core】【Web】新增WebM的VP9和OPUS编码支持

## 20210820

【Web】新增编辑预设功能

【Web】优化编码参数显示效果，原来是JSON，现在改为了格式化后的表单

【Web】优化了视频裁剪策略，支持单独设置开始时间、视频长度、结束时间

【Web】优化了视频裁剪设置的UI

## 20210821

【Web】新增支持Host设置开机自启，支持设置工作目录为当前目录

【Core】【Web】新增自定义参数任务

## 20210822

【Core】【Web】分离普通转码和视频拼接，普通转码输入多个文件时将输出多个文件。

【Core】【Web】转码的输入裁剪将和输入文件关联，而不是输出参数

## 20210823

【Web】改成了使用数据生成的菜单

【Web】做了主页

## 20210824

【WebAPP】新增由WinForms包装的可一键打开的桌面程序入口

## 20210825

【WebAPP】优化了WebApp：

- 退出时若在执行任务则禁止关闭
- 改为F12打开开发者选项
- 浏览器改为中文

【Web】新增支持从查看某一个任务的所有日志

## 20210826

【Core】【Web】接入了MediaInfo，查询媒体信息时可以查看更详细的信息

## 20210827

【Web】支持了选择子文件夹内的输入文件

【Core】将进程处理方法换成了自己的，更加好控制

## 20210830-20210906

【WPF】基本完成了WPF版本

## 20210905

【Web】修复了启用裁剪的任务加入队列后，新的任务虽然仍然勾选裁剪时间，但实际设置无效的BUG

【Web】优化时间裁剪设置，解析文本框保持可用，解析后自动启动该项裁剪

【Web】设置输入文件后将不会自动应用输出文件，而是在输出文件为空时，认为输出相同名称的文件。

## 20210908

【WPF】新增从任务列表中查看选中任务的日志

【WPF】新增日志根据类型进行筛选

【WPF】新增拖放加入文件

## 20210909

【WPF】修复了状态面板在有任务执行时反而显示无任务的BUG

【WPF】修复了视频比较不可用的BUG

【WPF】做了一些优化

## 20210911

【WPF】新增文件拖入主窗口即可新增任务

【WPF】新增任务栏进度条

【WPF】修复了一些新增任务时等参数面板的BUG

【WPF】修复了在任务进行时新增任务会报错的BUG

【WPF】新增ffmpeg和ffprobe命令的检测

【WPF】新增支持打开输入文件和输入文件的目录

## 20210912

【WPF】优化时间裁剪操作，输入框将保持可用，并与选择框联动

## 20210913

【WPF】修复了编辑完参数后，编辑框未失去焦点导致没有更新源数据的BUG

【WPF】修改任务界面，仅显示处理中任务的进度条，其他任务显示时间

## 20210919-20

【WPF】新增媒体信息查询

## 20210920

【WPF】新增平滑滚动

## 20210927

【WPF】修复了拼接时部分场景下报错的BUG

【WPF】修复了不可修改文件数目的任务类型仍可新增任务的BUG

## 20210930-1001

【WPF】新增视频可视化裁剪

【WPF】修改新建任务面板不再为主窗口的子窗口

## 20211002

【WPF】视频可视化裁剪新增快进和快退按钮

【WPF】优化新增任务，解决了新增时的卡顿，新增任务的同时开始队列改为切换按钮，新增后将切换到主窗口

【WPF】修复了更新预设无效的BUG

【WPF】新增删除预设功能

【WPF】修改了运行时关闭窗口的逻辑，当有任务正在进行中时，点击关闭按钮将会最小化到托盘而不询问。并取消了最小化到托盘按钮

【WPF】新增设置界面，可以设置平滑滚动和远程主机

【WPF】新增添加任务到远程主机功能

## 20211003

标注了各条日志所属的项目

【Web】修复了新增拼接、合并等任务时输出不可为空、不会检测输入文件存在性等BUG

【WPF】优化了任务详情显示

【WPF】新增创建任务后清空文件、创建任务后关闭窗口选项

【WPF】视频裁剪新增使用Ctrl和Shift切换快进快退的长度等，新增帧率显示

## 20211004

【WPF】优化了任务列表的显示，仅显示进行中的、排队中的任务以及其它在本次程序开启后的任务（类似Adobe Media Encoder

【WPF】新增所有任务显示窗口，支持分页

## 20211005

【WPF】修复了新增所有任务窗口部分按钮不隐藏的BUG

## 20211007

【WPF】修复了任务列表下方按钮点击报错的BUG

## 20211121

【WPF】调整了主界面大小等

【WPF】修复了帧率参数缺失的BUG

【WPF】新增预设窗口，支持删除、导入、导出

## 20211205

【Web】修复了文件名过长时，文件选择框中的其他文件选择不全或不显示的BUG